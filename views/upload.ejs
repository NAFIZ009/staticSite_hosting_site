<div class="relative py-24 sm:px-6 sm:py-26 lg:px-8 mx-auto">
  <div
    class="absolute left-1/2 z-10 mt-5 flex w-screen max-w-max -translate-x-1/2 px-4"
  >
    <div
      class="w-screen max-w-md flex-auto overflow-hidden rounded-3xl bg-white text-sm leading-6 shadow-lg ring-1 ring-gray-900/5"
    >
      <form onsubmit="zipFiles(event)" id="form" class="">
        <div class="p-4">
          <div class="mx-auto max-w-7xl px-2 lg:px-8 py-5">
            <div class="mx-auto max-w-2xl text-center">
              <h2 class="text-base font-semibold leading-7 text-indigo-600">
                Deploy Your website
              </h2>
              <p
                class="mt-2 text-3xl font-bold tracking-tight text-gray-900 sm:text-4xl"
              >
                Deploy Your Static Website
              </p>
              <p class="mt-6 text-lg leading-8 text-gray-600">
                Upload your <span class="font-bold">Project Directory</span>.The
                <span class="font-bold">Entry Point</span> of your website have
                to in the <span class="font-bold">Root Folder</span> and named
                as <span class="font-bold">index.html</span>
              </p>
            </div>
          </div>
          <div>
            <label
              for="price"
              class="block text-sm font-medium leading-6 text-gray-900"
              >Upload Your File</label
            >
            <div class="relative mt-2 rounded-md shadow-sm">
              <input
                type="file"
                name="upload"
                class="block w-full rounded-md border-0 py-1.5 pl-4 pr-20 text-gray-900 ring-1 ring-inset ring-gray-300 placeholder:text-gray-400 focus:ring-2 focus:ring-inset focus:ring-gray-600 sm:text-sm sm:leading-6"
                placeholder="Upload Your Directory"
                id="fileInput"
                webkitdirectory=""
                directory=""
                multiple
              />
            </div>
          </div>
        </div>
        <p class="my-6 ms-4 text-lg leading-8 text-gray-600">
          Want Deploy Single <a href="" class="font-bold">HTML File?</a>.
        </p>
        <div class="flex justify-center divide-x divide-gray-900/5 bg-gray-50">
          <button
            type="submit"
            class="flex items-center justify-center gap-x-1 p-3 font-semibold text-gray-900 hover:bg-gray-100 w-full"
          >
            <i class="fa-solid fa-cloud-arrow-up flex-none text-gray-400"></i>
            <span class="font-bold">Upload</span>
          </button>
        </div>
      </form>
      <div class="p-12 text-center hidden" id="url-box">
        <h2 class="text-3xl font-bold tracking-tight sm:text-4xl text-indigo-600">Your Site Is Deployed</h2>
        <span class="font-bold">Link:</span><br>
        <a class="text-xl font-bold tracking-tight text-gray-600 hover:underline" target="_blank" id="link"></a>
      </div>
    
    </div>
  </div>
</div>
<script>
  // document.getElementById('form').classList.remove("hidden");
  function zipFiles(e) {
    e.preventDefault();
    const files = e.target.upload.files;
    const zip = new JSZip();

    if (files.length > 0) {
      for (let i = 0; i < files.length; i++) {
        const file = files[i];
        if (
          file.type == "text/html" ||
          file.type == "text/css" ||
          file.type == "text/javascript" ||
          file.type == "image/jpeg"
        ) {
          zip.file(file.webkitRelativePath, file);
        }
      }

      zip.generateAsync({ type: "blob" }).then(function (content) {
        // Trigger download of the zip file
        const blob = new Blob([content], { type: "application/zip" });
        const formData = new FormData();
        formData.append("upload", blob);
        fetch("/upload/", {
          method: "POST",
          body: formData,
        }).then((res) =>res.json())
        .then((obj)=>{
          console.log(obj);
          const {status,siteURL}=obj;
          if(status=='success')
          {
            document.getElementById('form').classList.add('hidden');
            document.getElementById('url-box').classList.remove('hidden');
            document.getElementById('link').innerHTML=siteURL;
            document.getElementById('link').href=siteURL;
          }
        })
      });
    }
  }
</script>
